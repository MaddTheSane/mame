0.106u7
-------


MAMETesters Bugs Fixed
----------------------
namcond1_0106u3yel [Aaron Giles]



Source Changes
--------------
Improvements to the Sang Ho driver, making them somewhat playable.
[David Haywood, Tomasz Slanina]

Fixed off-by-one drawing error in the Pasha Pasha 2 driver.
[Pierpaolo Prazzoli]

Fixed some instruction forms in the 6309 diassembler to consume
the correct number of bytes. [Nicola Salmoria]

Added back support for DirectDraw. Unlike the old support, this 
requires DirectX 7 or later. There is now a new option to control
what video system is being used for rendering. Use -video d3d to use
Direct3D. Use -video ddraw to use DirectDraw. And use -video gdi to
force the use of GDI for rendering. Also added back the -hwstretch
option to control whether or not DirectDraw does stretching. Added
support for the -prescale option when using DirectDraw as well. It
should also work ok with multiple screens. [Aaron Giles]

Added a compile-time option to rendersw.c to prevent reads from the
destination. This removes the ability to do a number of blends and
effects, but allows you to point the software renderer at a video
memory target and not kill performance. It also improves performance
of software rendering in general by avoiding expensive alpha blending
operations. [Aaron Giles]

Improved font logic so that small fonts are scaled more appropriately
at low resolutions. It's not perfect, but works well for most games
when running with the new DirectDraw option, which always renders
games at minimum resolution. [Aaron Giles]

Fixed bug that messed up partial updating. Hopefully it all should be
back to normal again. [Aaron Giles]



0.106u6
-------


MAMETesters Bugs Fixed
----------------------
wboysys2_0106u4gra [Canim]



Source Changes
--------------
Minor fix for x64 compilation support with MSVC. [Malice]

Updated astdelux and omegrace built-in overlays for the new render
system.

Fixed inputs in the mcr68 drivers. [Peale]

Fixed new debugger support for custom register lists.
[Tim Schuerewegen]

Added workaround to make the V60 core work properly on GCC 4.x 
(tested on 4.1.1). [R. Belmont]

Fixed the drc blitters better. [Olivier Galibert]

Improvements to Polygonet Commanders: [R. Belmont]
 * Fixed Z80 IRQ/NMIs to go to the right CPU again
 * Modernized memory map
 * Added network status bit, so the initial test passes well enough 
    to make the DSP56k crash on unimplemented opcodes

Miscellaneous cleanups to the Atari/Max-A-Flex driver, attempting to 
modernize it. [Nathan Woods]

Updated Sega multi-32 driver to support multiple screens. 
[Aaron Giles]

Backed off of the multithreading for the moment in order to focus on
getting the rest of the kinks out of the new renderer. All the
infrastructure is still in place and can be re-enabled by flipping
the ENABLE_THREADS flag in window.c. [Aaron Giles]

Added support for "stretch to fit" when configuring a render target.
Added back the "-keepaspect" option as a result. [Aaron Giles]

Added clamping to the prescale effect so that it doesn't try to 
create excessively large textures. Explicitly reset render states so
that the prescale step is not filtered. Fixed StretchRect usage so
that it doesn't filter on some video cards. [Aaron Giles]

Fixed behavior of pixel aspect ratio when configuring render targets
(was correcting in the wrong direction). [Aaron Giles]

Moved thread priority logic out of ticker.c and into winmain.c where
it really belongs. [Aaron Giles]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Pasha Pasha 2 [Pierpaolo Prazzoli]
Rock Tris [Pierpaolo Prazzoli]
Mahjong X-Tal 7 / Mahjong Diamond 7 [Luca Elia]
Janputer '96 (Japan) [Luca Elia]
Watashiha Suzumechan [Luca Elia]



New clones added
----------------
Space Fury (revision B) [Highwayman]
Double Point (Dong Bang Electron) [David Haywood]



New games marked as GAME_NOT_WORKING
------------------------------------
Red Corsair [David Haywood]
Puzzle Star? (Sang Ho) [David Haywood, Tomasz Slanina]
Sexy Boom [David Haywood, Tomasz Slanina]
Super Free Kick [David Haywood]
High Seas Havoc [David Haywood]
Bombs Away [David Haywood, Andrew Gardner]



0.106u5
-------

WARNING: Starting with this version, the MAME windows run on a
separate thread. There may be issues relating to this, especially
when running unthrottled. If you see any crashes or odd behavior
under normal operation, be sure to report it to 
http://mametesters.org.



MAMETesters Bugs Fixed
----------------------
cheat_menu0106u3ora [Aaron Giles]
cheat_file_option0106u3ora [Aaron Giles]



Source Changes
--------------
Cleaned up decocass driver: [Juergen Buchmueller]
 - All hardcoded tables are gone now
 - cexplore.pro 32 byte PROM reverse engineered

Fixed windows.mak to support 64-bit builds. [Malice]

Fixed bug where the gamename was reallocated out from under us by
the new config system. [Nathan Woods]

Added the ability to specify a callback when a given option is 
parsed.  This is used on the MESS side to add system-specific
command line options. [Nathan Woods]

More generic 6840 improvements. [El Condor]

Some improvements to the Pasha Pasha 2 driver. [Pierpaolo Prazzoli]

Added experimental OSD locks: [Aaron Giles]
 - osd_lock_alloc() allocates a lock
 - osd_lock_acquire() acquires a lock, blocking until success
 - osd_lock_try() tries to acquire a lock and returns whether or
    not it succeeded
 - osd_lock_release() releases a lock
 - osd_lock_free() frees memory used by a lock
If the OSD layer is not using multiple threads, these can just be
stubbed out (return TRUE for osd_lock_acquire and fake the rest).

Fixed ESC key not cancelling out of initial UI screens. [Aaron Giles]

More rendering changes/fixes: [Aaron Giles]
 - Added new render_view_item_get_state() function to return the
    state of a given item
 - Changed render_target_get_primitives to return a new structure
    render_primitive_list, which contains the list of primitives
    along with an osd_lock which must be held while the list is
    being traversed
 - Added "Rotate View" option to the video menu for dynamic in-game
    rotation
 - Moved window creation and management to a separate thread; this
    means all software rendering and all Direct3D calls are done on
    a separate thread from the main game, and will take advantage of
    multiple CPUs/dual cores
 - Changed throttling behavior to skip rendering if we are already
    pending; this makes for a better "fast forward" effect
 - Added -prescale option to pre-scale the game bitmaps before
    rendering to the screen; this helps get rid of the "fuzzy" look
    when running with -filter enabled, at the expense of some speed.
    Note that only integral values are currently supported (no "auto")



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Hard Times [Pierpaolo Prazzoli]



0.106u4
-------


MAMETesters Bugs Fixed
----------------------
atarigt0106u3red [Aaron Giles]
bestmatch0106u3ora [Aaron Giles]
midyunit0106u3red [Aaron Giles]



Source Changes
--------------
Added new function mame_debug_is_active() which can be used by
core code to identify when we are paused in the debugger.
[Aaron Giles]

Fixed crash when passing an invalid driver name on the command line.
Centralized the approximate matching logic into driver.c so other
ports can use it as well. [Aaron Giles]

Now properly extracting path from driver name and adding it to the
rompath so that drag & drop of ZIP files works once again.
[Aaron Giles]

More renderer updates: [Aaron Giles]
 - Fixed feature detection bug that led to false-positive warnings
    when starting up
 - Removed extra vertex padding since some graphics cards could not
    cope with it
 - Added shims to support both Direct3D 9 and Direct3D 8; D3D9 is
    the default, with an automatic fallback to d3d8 if not available
 - New option -d3dversion can be used to specify preferred version
    for testing
 - Added 1 pixel black border around all textures to ensure filtering
    on some cards doesn't result in garbage at the edge of the screen
 - Enabled "do not wait" feature when unthrottled and using D3D9; this
    greatly speeds up unthrottled games, but seems to only work in 
    full screen mode
 - Switched from triangle fans to triangle strips
 - Ensured that render states are only being set minimally
 - Added code to reset the device if lost, allowing application 
    switching out of full screen mode and fixing multi-monitor mode
    with resolution switching

Added new function verbose_printf() which is used instead of checking
the verbose global to print information to the screen. Changed all
locations that were checking the global to use this new function.
[Aaron Giles]



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Card Line [Tomasz Slanina]



0.106u3
-------

WARNING: As of this build, the new rendering system is enabled by
default. The primary focus at this point is compatibility, not
performance. Compared to the old -ddraw system, it will appear
slower when fully unthrottled because there is not a good mechanism
to skip the render if the graphics hardware is still busy like we
used to do. If you have any trouble getting a correct display or
if you get warning messages printed out when starting MAME, please
post about them on http://mametesters.org.

SECONDARY WARNING: The command line and INI parsing code was
rewritten. If you notice any problems with handling of parameters
in either case, please report the bugs on http://mametesters.org.



MAMETesters Bugs Fixed
----------------------
colmns970105gra [Mariusz Wojcieszek]



Source Changes
--------------
Added a size parameter to osd_free_executable(). [Olivier Galibert]

Fixed flash rom writes in dgpix games. [Pierpaolo Prazzoli]

More fixes/improvements to jalmah.c DIP switches: [Roberto Fresca]
 Kakumei:
  - Added flip screen DIP switch.
 Daireika, urashima & mjzoomin:
  - Added flip screen DIP switch.
  - Fixed test/service DIP switch.
  - Fixed complete coinage.
 
Added save state support to the 1942, 1943 and 1945kiii drivers. 
[Lee Mitchell]

Fixed blitters to work with 15-bit direct RGB modes. [Nathan Woods]

Refactored resource tracking code, auto_malloc(), auto_strdup() 
etc into a separate module, restrack.c. [Nathan Woods]

Moved large stack buffers into heap buffers to work better on systems
with small stacks. [Lawrence Gold]

Fixed a subtle auditing issue when both parents and clones had
NO_DUMP ROMs in their manifests. [Hobbes@Play]

Tweaks to the MSVC compiler support: [AtariAce]
 - Removed _MSC_VER specific #pragmas in nec.c
 - Removed _MSC_VER specific #include <malloc.h> in winprefix.h
 - Changed makefile to bootstrap vconv.exe with cl instead of gcc
 - Changed calls to lib to use link /lib instead
 - Updated vconv to only use /arch:SSE2 for VC71 and later
 - Cleaned up the profiler code in winmain.c
 - Removed the direct dependency of MAME on shell32 has been 
 - Tweaked a couple of preprocessor definitions so we compile as far
    back as MSVC 5.0

Massive DIP switch update to the following drivers: actfancr,
aliens, angelkds, argus, asuka, bwing, compgolf, cop01, dblewing,
dec8, dogfgt, dooyong, fuukifg2, homedata, jcross, kaneko16, m92, 
mainevt, megasys1, metro, ms32, nmk16, paradise, seta, seta2, 
shisen, snk, ssv, system1, taito_b, taito_f2, taito_l, tecmo,
thedeep, thepit, ultraman. [Brian Troha, Guru, Yasuhiro Ogawa]

Added code in the debug build to put random data in allocated memory.
[Aaron Giles]

Removed remaining chunks of x86 assembly code, as well as references
to NASM in the makefiles. [Aaron Giles]

Rewrote the options parsing code to be more flexible and generic.
A new core source file options.c provides the ability to add and
maintain a database of key/value pairs, which can be queried at
runtime. Reconnected all existing frontend options through this code. 
Bounds checking on options for the old renderer is pretty loose, and 
several more complicated options have been disconnected as a result. 
If you are still running with the old renderer, be careful.
[Aaron Giles]

Reorganized fronthlp.c to be one step closer to universal. One more
layer of abstraction and hopefully it will be able to move up into
the core. [Aaron Giles]

New options to control multiple screens in the new renderer:
[Aaron Giles]
 -numscreens specifies how many windows to create
 -screen0/screen1/... specifies the name of the screen for each window
 -resolution0/resolution1/... specifies resolution for each window
 -aspect0/aspect1/... specifies aspect ratio for each screen
 -view0/view1/... specifies starting view for each screen

Deprecated osd_skip_this_frame() with the new renderer. osd_update()
now returns TRUE if it wants to skip the following frame. [Aaron Giles]

Fixes to the new rendering system: [Aaron Giles]
 - Enabled new renderer by default
 - Fixed crash at startup due to uninitialized memory
 - Fixed crash at shutdown due to incorrect shutdown order
 - Fixed rendering of 15-bit direct RGB games
 - Fixed weird frameskipping issues
 - Fixed off-by-one error on visible area
 - Added proper clipping of quad primitives
 - Optimized the clearing step to avoid redundant drawing
 - Brought software-only case up to support all major blending types
 - Added support for -filter option
 - Reconnected snapshots, though they are unrotated and screen 0 only
 - Fixed several UI problems with new video options menu
 - More strongly defined the blending modes to produce correct effects
 - Added a flag to indicate textures that are of screen bitmaps



New games added or promoted from NOT_WORKING status
---------------------------------------------------
Mario Lemieux Hockey (Mega-Tech) [David Haywood, Guru]
Highway Chase (Cassette) [David Widel, Juergen Buchmueller]
Critter Crusher [Mariusz Wojcieszek, gbluma]
Daikaiju no Gyakushu [Tomasz Slanina, Guru]



New clones added
----------------
Turtle Ship (North America) [Brian Troha]



0.106u2
-------


IMPORTANT NOTE: The video system in this version has been completely
upended and redesigned. The old video system is still the default;
however, some features may be broken. These are not bug-worthy
reports, as the old system will soon be deprecated. The new system
can be compiled by setting the NEW_RENDER flag on in the makefile.

THE NEW SYSTEM IS STILL WORK-IN-PROGRESS! Apart from video card-
related issues (like it doesn't work on particular hardware or has
an incorrect display), bugs are not being tracked at this time.
There is already a laundry list of things that are broken at the
top of render.c, and there are many other things that still need
to be looked at.

In order to run the new video system with hardware acceleration, 
your machine will require DirectX 8 or later.



MAMETesters Bugs Fixed
----------------------
suchipi0106u1gra [Roberto Fresca]



Source Changes
--------------
Added support for circular buffering in the SHARC core, and fixed
several minor bugs. [Ville Linde]

Added color PROM support for Nintendo's Sheriff driver. 
[Stefan Jokisch]

Discrete sound updates: [Derrick Renaud]
 - Typedef'ed external discrete sound structures to follow current 
     structure use. Statically defined their use in most drivers to 
     stop name pollution.
 - Created new DISCRETE_555_VCO1 module.  This is the 555&Op-amp 
    oscillator circuit used by Borderline.

Added the new video rendering system. A new file render.c contains
the bulk of the logic. Major changes include: [Aaron Giles]
 - The OSD layer is now responsible for allocating one or more 
    render_targets at osd_init time. The old osd_create_display 
    and osd_close_display calls are not used with the new system, 
    so initialization must take place at osd_init time.
 - The old osd_update_video_and_audio call has now been replaced 
    with a simple osd_update call. This update call passes a 
    mame_time to the OSD layer, which is the current emulated time. 
    Throttling and speed calculations should use this time instead
    of the framerate.
 - osd_update is responsible for calling the render system to 
    request a list of primitives to be drawn on each render_target
    for the current frame. The primitives are simple and include
    clipping rectangles, lines, and rectilinear quads only.
 - If it wishes, the OSD layer can call back to a software
    rasterizer in MAME. The rasterizer code is provided as an
    include module so it can be tuned and optimized for platform-
    specific video modes. See windows/rendsoft.c for a usage
    example.
 - There is a new layout file format .lay, which is XML-based and
    which replaces the old .art files. The .lay files describe how
    to render to a render_target. Each layout file can contain
    multiple "views", which describe one of many ways the various
    elements can be drawn. These views can be selected at runtime
    via the new "Video Options" menu.
 - The built-in UI font can be overridden with any .BDF font. Simply
    name the .BDF file "ui.bdf" and place it in the MAME directory.
    If you run at decent resolutions, you should choose a large 
    point size for this font so that the scaled results look nice.
 - The windows implementation uses Direct3D 8 as the preferred
    mechanism for rendering. By default, it will render at the
    current resolution, rather than switching resolutions as before.
    This can be changed by adding -switchres to the command line.
 - There are still a number of imperfect/incomplete features with
    the new renderer, which is why it is not on by default. An
    incomplete list is given in render.c.



New clones added
----------------
WWF: Wrestlemania (rev 1.20 08/02/95) [Corrado Tomaselli]
Heavy Smash (Asia version -4) [Corrado Tomaselli]
Mad Alien (Highway Chase) [Stefan Jokisch]



New games marked as GAME_NOT_WORKING
------------------------------------
Pasha Pasha 2 [Pierpaolo Prazzoli]
Trivia Madness [Pierpaolo Prazzoli]



0.106u1
-------

IMPORTANT NOTE: Major video-related changes are beginning in the
system. Attempts will be made to keep the existing video code
working to a large degree, but some features may be broken or
working improperly until the video changes are complete. Most
notably, in this release, RGB effects are broken for non-Direct3D
blitting. For the moment, do not report anomalies or problems in 
the video system. If you like a nice, stable MAME, please stick 
with the 0.106 release. You have been warned.



MAMETesters Bugs Fixed
----------------------
gladiatr0105u4gra [Don Maeby]



Source Changes
--------------
Updates to the taito_x driver: [AWJ]
 - fixed sound problems in twinhawk
 - fixed a couple of dipswitch mistakes introduced recently
 - added PORT_DIPLOCATIONs for superman and twinhawk

Improved MSVC compiler support: [Nathan Woods]
 - modified vconv to support multiple versions of MSVC based on 
    version info
 - added support for more parameter translations
 - makefile now displays compiling and linking messages when
    building vconv

Converted the Windows blitters to use the DRC engine for 
generation. RGB effects are officially broken with this change.
[Nathan Woods]

Fixed a bug that caused a crash when the -debugscript command line 
option was used with an invalid filename. [Nathan Woods]

Corrected the ordering of the DIP_PORTLOCATION() macros to be
consistent. Multi-bit DIP switches should be specified in LSB-
first order. Added a comment to this effect in inptport.h.
[AWJ, Aaron Giles]

Fixed background color in the Deco cassette games.
[Nicola Salmoria]

Fixed potential crash in the micro3d driver. [MamePlus!]

Improvements to CHD-CD support: [R. Belmont]
 - additional RAW CD sector conversion support, so a game can request 
    e.g. 2048-byte data sectors from a RAW CHD-CD and still get the 
    right data
- reversed CHDMAN error message - now non-RAW CHD-CDs are deprecated
- susume now uses a RAW CHD-CD read directly from an original pressed 
   Konami disc

Some improvements to the Polygonet Commanders driver: [Andrew Gardner]
 - adds change_PC() calls to the dsp56k core
 - removed hacky dsp56k initialization, enabling, and disabling
 - added preliminary implementation of banking hardware tied to the 
    dsp56k in Polygonet Commanders

Fixed MSB accesses and latch reading in the 6840 emulator. [El Condor]

Improved N64 audio output: [R. Belmont]
 - rewrote Audio Interface as a stereo DMADAC (which it actually is), 
    greatly simplifying the code along the way
 - fixed AI interrupt semantics

Changed a number of games that were incorrectly using IPT_LIGHTGUN
to use IPT_AD_STICK instead. [Aaron Giles]

Some preparations for proper multiple screen support. The 
visible_area and refresh_rate values in the Machine structure are
now defined as arrays (1 per screen). The machine_config structure
has been altered as well, removing the following fields:

   frames_per_second
   aspect_x, aspect_y
   screen_width, screen_height
   default_visible_area
   vblank_duration

These are all stored per-screen in a new screen_config structure. 
[Aaron Giles]

Reorganized the user interface code to better support the new render
system. [Aaron Giles]
